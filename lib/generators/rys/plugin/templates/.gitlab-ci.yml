# Before_script is used to define the command that should be run before all
# jobs, including deploy jobs, but after the restoration of artifacts. This can
# be an array or a multi-line string.
before_script:
  - export HOME=/home/gitlab-runner
  - export LC_ALL=en_US.UTF-8
  - export RAILS_ENV=test
  - ''
  - '[[ -z $RUBY_VERSION ]] && RUBY_VERSION="2.4.2"'
  - ''
  - rvm use ruby $RUBY_VERSION >/dev/null 2>&1
  - ruby -v

variables:
  REPO: easyredmine/stable-2016
  MYSQL_USERNAME: root
  MYSQL_PASSWORD: $MYSQL_PASS
  PG_USERNAME: postgres
  PG_PASSWROD: ''

stages:
  - me
  - ryses
  - easy

# -----------------------------------------------------------------------------
# Stage: Me

Me / MySQL:
  stage: test
  tags:
  - mysql
  script:
  - bin/easy_core ci-run-easy --mysql --test me

# -----------------------------------------------------------------------------
# Stage: Ryses

Ryses / MySQL:
  stage: test
  tags:
  - mysql
  script:
  - bin/easy_core ci-run-easy --mysql --test ryses

# -----------------------------------------------------------------------------
# Stage: Easyproject

Easyproject / MySQL:
  stage: test
  tags:
  - mysql
  script:
  - bin/easy_core ci-run-easy --mysql --test easyproject
