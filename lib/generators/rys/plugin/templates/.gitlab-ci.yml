# Before_script is used to define the command that should be run before all
# jobs, including deploy jobs, but after the restoration of artifacts. This can
# be an array or a multi-line string.
before_script:
  - export HOME=/home/gitlab-runner
  - export LC_ALL=en_US.UTF-8
  - export RAILS_ENV=test
  - ''
  - '[[ -z $RUBY_VERSION ]] && RUBY_VERSION="2.4.2"'
  - ''
  - rvm use ruby $RUBY_VERSION >/dev/null 2>&1
  - ruby -v


# -----------------------------------------------------------------------------
# Stage: Test

MySQL:
  stage: test
  tags:
  - mysql
  script:
  - bundle install
  - bin/easy_core run-easy-tests-ci

# PostgreSQL:
#   stage: test
#   tags:
#   - postgresql
#   script:
#   - ruby ./.dummy_control.rb -a postgresql
#   - bundle install --without xapian rmagick
#   - rake db:migrate
#   - pwd
#   - bundle exec rspec

